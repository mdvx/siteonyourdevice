<html>
    <head>
        <script src="scripts/script.js" type="text/javascript"></script>
        <script src="http://siteonyourdevice.com:3000/socket.io/socket.io.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script>
            const CHANNEL_IN = 'COMMANDS_IN';
            const CHANNEL_OUT = 'COMMANDS_OUT';
            const NODE_PORT = 3000;
            
            //socket io client
            //var io = require('socket.io');
            var socket = io.connect('http://siteonyourdevice.com:3000');
            var id_command = 11;
            
            //on connetion, updates connection state and sends subscribe request
            socket.on('connect', function(data){
                socket.emit('subscribe', {channel:CHANNEL_OUT});
            });

            //when reconnection is attempted, updates status 
            socket.on('reconnecting', function(data){
            });

            //on new message adds a new message to display
            socket.on('message', function (data) {
                if (data.channel !== CHANNEL_OUT) {
                    return; 
                }
                
                var msg = data.text;
                var msgObj = parse_command_out(msg);
                if(msgObj == undefined){
                    return;
                }
                
                if(id_command !== msgObj.id){
                    return;
                }
                
                addMessage(msg);
            });

            //adds message to messages div
            function addMessage(msg) {
                var str = '<div class="message">' + msg + '</div><hr>';
                console.log(str)
                $('#messages').append(str)
            }

            var server_name;
            function init()
            {
                server_name = get_url_parameter('site');
                $('.server_name_label').html(server_name);
            }
        </script>

    </head>
    <body onload = "init()">
        <div class="server_name_label"></div>
        <button onclick="ping_server(id_command, server_name, socket)">Ping</button>
        <div id="messages"></div>
    </body>
</html>
